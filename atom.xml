<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>MILLETBARD</title>
  
  <subtitle>前端技術筆記</subtitle>
  <link href="https://milletbard.github.io/atom.xml" rel="self"/>
  
  <link href="https://milletbard.github.io/"/>
  <updated>2022-06-18T15:43:05.884Z</updated>
  <id>https://milletbard.github.io/</id>
  
  <author>
    <name>milletbard</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>什麼是 CJS ? 什麼是 ESM ?</title>
    <link href="https://milletbard.github.io/commonjs-vs-esm.html"/>
    <id>https://milletbard.github.io/commonjs-vs-esm.html</id>
    <published>2022-06-15T16:44:38.000Z</published>
    <updated>2022-06-18T15:43:05.884Z</updated>
    
    <content type="html"><![CDATA[<p><img src="./commonjs-vs-ESM/img.jpg" alt=""></p><h2 id="目錄"><a href="#目錄" class="headerlink" title="目錄"></a>目錄</h2><ul><li><a href="#目錄">目錄</a></li><li><a href="#esm-和-cjs-是完全不同的">ESM 和 CJS 是完全不同的</a></li><li><a href="#esm-改變了很多事情">ESM 改變了很多事情</a></li><li><a href="#esm-靜態模組結構-static-module-structure">ESM 靜態模組結構 (static module structure)</a><ul><li><a href="#tree-shaking">Tree Shaking</a></li><li><a href="#更緊湊的-bundle">更緊湊的 bundle</a></li><li><a href="#更快的查詢並導入">更快的查詢並導入</a></li></ul></li><li><a href="#esm-不能-import-命名導出的-cjs">ESM 不能 import 命名導出的 CJS</a></li><li><a href="#cjs-不能-require-esm">CJS 不能 require() ESM</a></li><li><a href="#cjs-可以-import-esm-但不是很方便">CJS 可以 import() ESM 但不是很方便</a></li><li><a href="#如何使-cjs-的-默認導出-可以使用-命名導出">如何使 CJS 的 <code>默認導出</code> 可以使用 <code>命名導出</code></a></li><li><a href="#結語">結語</a></li><li><a href="#參考">參考</a></li></ul><p>從 Node 誕生開始 CommonJS(CJS)就被廣泛使用來進行開發，透過 <code>require()</code> 引入它們，當實作了 script，提供給他人使用，可以定義 <code>exports</code>,使用 <strong>命名導出</strong> <code>module.exports.foo = &#39;bar&#39;</code> 或是 <strong>默認導出</strong> <code>module.exports = &#39;baz&#39;</code> 的方式導出 script。</p><p><strong>ESM 和 CJS 是完全不同的</strong>。儘管從表面上來看，ESM 看起來非常相似。</p><p>使用 <strong>命名導出</strong> 的 CJS 範例</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @filename: utils.CJS</span></span><br><span class="line"><span class="built_in">module</span>.exports.sum = <span class="function">(<span class="params">x, y</span>) =&gt;</span> x + y;</span><br><span class="line"><span class="comment">// @filename: main.CJS</span></span><br><span class="line"><span class="keyword">const</span> &#123; sun &#125; = <span class="built_in">require</span>(<span class="string">"./utils.CJS"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">2</span>, <span class="number">4</span>));</span><br></pre></td></tr></table></figure><p>使用 <strong>默認導出</strong> 的 CJS 範例</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @filenameL util.CJS</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">x, y</span>) =&gt;</span> x + y;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @filenameL main.CJS</span></span><br><span class="line"><span class="keyword">const</span> whateverWeWant = reuqire(<span class="string">"./util.CJS"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(whateverWeWant(<span class="number">2</span>, <span class="number">4</span>));</span><br></pre></td></tr></table></figure><p>在 ESM 中，使用 <code>import</code> 與 <code>export</code> ，對於 <strong>命名導出</strong> 和 <strong>默認導出</strong> 也有兩種不同的語法。</p><p>使用 <strong>命名導出</strong> 的 ESM 範例。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @filename: util.mjs</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> sum = <span class="function">(<span class="params">x, y</span>) =&gt;</span> x + y;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@filename: main.mjs</span></span><br><span class="line"><span class="keyword">import</span> &#123; sum &#125; <span class="keyword">from</span> <span class="string">"./util.mjs"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">2</span>,v <span class="number">4</span>));</span><br></pre></td></tr></table></figure><p>使用 <strong>默認導出</strong> 的 ESM 範例。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @filename: util.mjs</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (x, y) =&gt; x + y;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@filename: main.mjs</span></span><br><span class="line"><span class="keyword">import</span> whateverWeWant <span class="keyword">from</span> <span class="string">"./util.mjs"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(whateverWeWant(<span class="number">2</span>, <span class="number">4</span>));</span><br></pre></td></tr></table></figure><hr><h2 id="ESM-和-CJS-是完全不同的"><a href="#ESM-和-CJS-是完全不同的" class="headerlink" title="ESM 和 CJS 是完全不同的"></a>ESM 和 CJS 是完全不同的</h2><ul><li>在 CJS 中，<code>imports</code> 會 <strong>複製</strong> 一份 exports 的內容來使用。</li><li>在 ESM 中，<code>imports</code> 是使用 <a href="#ESM-靜態模組結構-static-module-structure">靜態結構</a> 的 <code>read-only view</code> 來使用裡面的內容。</li></ul><blockquote><p><a href="https://exploringjs.com/es6/ch_modules.html#sec_imports-as-views-on-exports" target="_blank" rel="noopener">16.7 Details: imports as views on exports</a></p></blockquote><p><strong><code>CJS</code></strong> 是 <code>require</code> 是同步的，它不會回傳 <code>Promise</code> 或 <code>callback</code>，</p><p><strong><code>ESM</code></strong> 以非同步的方式加載，它依賴於 <code>ES6 aka ES2015</code> 的 <a href="https://exploringjs.com/es6/ch_modules.html#static-module-structure" target="_blank" rel="noopener">靜態結構</a>。</p><p>之後 <code>Module Loader</code> 會下載以及解析我們導入的所有 scripts，再來會輪到 scripts 所依賴的 scripts，然後建構依賴的 <code>模組地圖</code> (ES module graph)，直到找到沒有再導入任何 scripts 的 script。最後，允許執行該 scripts，再允許運行該 script 依賴的 script，以此類推。</p><p>建構出來的 <code>模組地圖</code> (ES module graph) 的 scripts 都是併行下載的，但它們會按照順序執行，由 <code>Module Loader</code> 的規範保證。</p><h2 id="ESM-改變了很多事情"><a href="#ESM-改變了很多事情" class="headerlink" title="ESM 改變了很多事情"></a>ESM 改變了很多事情</h2><p>ESM 改變了 Javascript 很多事情，首先，ESM script 默認使用嚴格模式 (use strict)，它們的 <code>this</code> 不會引用全局物件，作用域的運作方式不同等等。</p><p>這就是為什麼即使在瀏覽器中，&lt;script&gt; 標籤的默認設定不是 ESM 的；必須添加 <code>type=&quot;module&quot;</code> 才可以進入 ESM 模式，將默認設定從 CJS 切換到 ESM 將會是對兼容性的重大突破。</p><h2 id="ESM-靜態模組結構-static-module-structure"><a href="#ESM-靜態模組結構-static-module-structure" class="headerlink" title="ESM 靜態模組結構 (static module structure)"></a>ESM 靜態模組結構 (static module structure)</h2><p>靜態結構的意思是可以在編譯期間 <strong>靜態的</strong> 確定 <code>import</code>或 <code>export</code>，<code>ESM Loader</code> 會在不運行程式碼的情況下解析 <code>import</code> 與 <code>export</code>；在解析階段， <code>ESM Loader</code> 可以在沒有真正 <strong>運行程式碼之前</strong> 立即的找出 <code>命名導入</code> 因拼寫錯誤而引發的異常。</p><p>只能在程式碼最上層 (top-level) 使用 <code>export 或 import</code> (不能放在條件式中)，並且 <code>import</code> 和 <code>export</code> (不允許使用變數)。</p><p>下面是沒有 <strong>靜態結構</strong> 的 CJS 的兩個範例:</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> my_lib;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Math</span>.random()) &#123;</span><br><span class="line">  my_lib = <span class="built_in">require</span>(<span class="string">"foo"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  my_lib = <span class="built_in">require</span>(<span class="string">"bar"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果沒有給 <code>else</code>，您必須運行代碼以找出它導出的內容：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">Math</span>.random()) &#123;</span><br><span class="line">    exports.baz = ···;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ESM 會強制保持靜態結構，因此可以得到好處:</p><ol><li><a href="#tree-shaking">Tree Shaking，打包期間移除沒有用到的代碼</a></li><li><a href="#更緊湊的-bundle">更緊湊的 bundle</a></li><li><a href="#更快的查詢並導入">更快的查詢並導入</a></li></ol><h3 id="Tree-Shaking"><a href="#Tree-Shaking" class="headerlink" title="Tree Shaking"></a>Tree Shaking</h3><blockquote><p>可以將應用程式想像成一棵樹，實際使用到的 code 和 library 代表了綠色的還活著的葉子。死掉的程式碼代表枯萎的褐色葉子，為了擺脫枯葉，必須搖動樹，使它們掉落。</p></blockquote><p>在開發過程中，模組通常會這樣處理:</p><ul><li>開發過程，程式碼存在在許多模組 (通常很小)</li><li>執行部屬，這些模組會被 bundle 並分類到幾個較大的區塊中</li></ul><p>bundle 的原因:</p><ul><li>下載 bundle 時需要索引的文件更少</li><li>壓縮 bundle 後的檔案擁有更好的效能</li><li>可以在 bundle 期間刪除不必要的檔案</li></ul><p>為了利用 <code>Tree Shaking</code> 的優勢有幾點需要注意：</p><ul><li>必須使用 ESM (<code>import</code> 和 <code>export</code>)</li><li>確保編譯器沒有將 ESM 轉換成 CJS (這是 Babel 預設 @Babel 預設 @babel/preset-env 的默認行為，參閱 <a href="https://babeljs.io/docs/en/babel-preset-env#modules" target="_blank" rel="noopener">文檔</a> )</li><li>將 <code>sideEffects</code> 屬性加入倒 package.json</li><li>啟用 <code>webpack</code> 的 <code>production mode</code> 配置開啟 <a href="https://webpack.js.org/configuration/mode/#usage" target="_blank" rel="noopener">各種優化</a>。</li></ul><h3 id="更緊湊的-bundle"><a href="#更緊湊的-bundle" class="headerlink" title="更緊湊的 bundle"></a>更緊湊的 bundle</h3><p><a href="https://github.com/rollup/rollup" target="_blank" rel="noopener">The module bundler Rollup</a> 證明了 ESM 可以有效的組合，因為它們都適合單個範圍 (在重命名變數以消除變數衝突之後)，這也仰賴於 ESM 的兩個特性：</p><ul><li><p>都是靜態結構意味著　 bundle 格式不需要考慮條件式載入的模組</p></li><li><p><code>import</code> 是 <code>export</code> 的 read-only view。這意味著不必複製一份並導出，可以直接使用它們。</p></li></ul><p>例如，以下兩個 ESM 的範例</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">"./lib.js"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(foo);</span><br></pre></td></tr></table></figure><p>Rollup 會將這兩個模組綁到單個 ES6 模組之下(刪除沒用到的 bar)</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(foo());</span><br></pre></td></tr></table></figure><h3 id="更快的查詢並導入"><a href="#更快的查詢並導入" class="headerlink" title="更快的查詢並導入"></a>更快的查詢並導入</h3><p>如果需要 import CJS 的 libary，會得到一個物件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lib = <span class="built_in">require</span>(lib);</span><br><span class="line">lib.someFunc(); <span class="comment">// property loopup</span></span><br></pre></td></tr></table></figure><p>必須通過屬性去使用 <code>lib.someFunc</code>，這樣沒有效率，因為它是動態結構。</p><p>相反的，如果是使用 ESM import 某個 library，因為是靜態結構，我們可以很清楚的知道它裡面有什麼變數可以使用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> lib <span class="keyword">from</span> <span class="string">"lib"</span>;</span><br><span class="line">lib.someFunc(); <span class="comment">// statically resolved</span></span><br></pre></td></tr></table></figure><h2 id="ESM-不能-import-命名導出的-CJS"><a href="#ESM-不能-import-命名導出的-CJS" class="headerlink" title="ESM 不能 import 命名導出的 CJS"></a>ESM 不能 import 命名導出的 CJS</h2><p>可以這樣做</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">"lodash.CJS "</span>;</span><br></pre></td></tr></table></figure><p>但不能這樣</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shuffle &#125; <span class="keyword">from</span> <span class="string">"lodash.CJS"</span>;</span><br></pre></td></tr></table></figure><p>這是因為 CJS script 是在執行期間計算 <code>命名導出</code>，而 ESM 則是在解析階段計算。</p><p>ESM 可以使用 <code>require</code></p><p><code>require</code> 在 ESM script 默認不在使用範圍內，但可以透過以下方式使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRequire &#125; <span class="keyword">from</span> <span class="string">"module"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">require</span> = createRequire(<span class="keyword">import</span>.meta.url);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; foo &#125; = <span class="built_in">require</span>(<span class="string">"./foo.CJS"</span>);</span><br></pre></td></tr></table></figure><p>但是這樣的方式沒有實質上的幫助，實際上只是需要撰寫更多的程式碼，而且不僅僅是執行默認 import 與解構，像 webpack、Rollup 這樣的打包工具也不知道該怎麼處理 <code>createRequire</code> 模式，這樣就變得沒那麼有意義。</p><h2 id="CJS-不能-require-ESM"><a href="#CJS-不能-require-ESM" class="headerlink" title="CJS 不能 require() ESM"></a>CJS 不能 require() ESM</h2><p>CJS 不能 <code>require</code> ESM 的最簡單原因是因為 ESM 可以做 top-level <code>await</code>，而 CJS scripts 不行。</p><blockquote><p>top-level <code>await</code> 可以讓我們在 async function 之外使用 <code>await</code> 關鍵字。<br>ESM 的 multi-pasge loader 使 ESM 可以實現 top-level <code>await</code>。</p></blockquote><p>由於 CJS 不支援 top-level <code>await</code>，因此甚至不可能將 ESM top-level <code>await</code> 轉換為 CJS。</p><h2 id="CJS-可以-import-ESM-但不是很方便"><a href="#CJS-可以-import-ESM-但不是很方便" class="headerlink" title="CJS 可以 import() ESM 但不是很方便"></a>CJS 可以 import() ESM 但不是很方便</h2><p>如果想要使用 CJS import ESM script，可以使用 dynamic import 的方式:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; foo &#125; = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">"./foo.mjs"</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="如何使-CJS-的-默認導出-可以使用-命名導出"><a href="#如何使-CJS-的-默認導出-可以使用-命名導出" class="headerlink" title="如何使 CJS 的 默認導出 可以使用 命名導出"></a>如何使 CJS 的 <code>默認導出</code> 可以使用 <code>命名導出</code></h2><p>為 CJS 命名導出提供一個 ESM wrapper</p><blockquote><p>為 CJS libraries 提供 ESM wrapper 很容易，但永遠不可能為 ESM libraries 提供 CJS wrapper</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> CJSModule <span class="keyword">from</span> <span class="string">"../index.js"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> foo = CJSModule.foo;</span><br></pre></td></tr></table></figure><p>將 ESM wrapper 放在 <code>ESM</code> 的子目錄，同層的 <code>package.json</code> 的 增加 <code>{&quot;type&quot;:&quot;module}</code>.</p><h2 id="結語"><a href="#結語" class="headerlink" title="結語"></a>結語</h2><ul><li>CJS 使用 <code>require</code>、<code>exports</code>，ESM 使用 <code>import</code>、<code>export</code></li><li>ESM 和 CJS 是完全不同的</li><li>CJS 是同步的，它不會回傳 <code>promise</code> 或 <code>callback</code>且是動態結構，ESM Module Loader 是異步的，並在運行前解析成靜態結構</li><li>ESM 解析出來的 <code>Module Graph</code> 會並行下載但會依序執行。</li><li>ESM 強制的靜態結構帶來了許多好處。</li><li>ESM 不能 import <code>命名導出</code> 的 CJS。</li></ul><h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><ul><li><a href="https://exploringjs.com/es6/ch_modules.html#static-module-structure" target="_blank" rel="noopener">static-module-structure</a></li><li><a href="https://webpack.js.org/guides/tree-shaking/" target="_blank" rel="noopener">webpack - Tree Shaking</a></li><li><a href="https://redfin.engineering/node-modules-at-war-why-commonjs-and-es-modules-cant-get-along-9617135eeca1" target="_blank" rel="noopener">Node Modules at War: Why CommonJS and ES Modules Can’t Get Along</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;./commonjs-vs-ESM/img.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;目錄&quot;&gt;&lt;a href=&quot;#目錄&quot; class=&quot;headerlink&quot; title=&quot;目錄&quot;&gt;&lt;/a&gt;目錄&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#目錄</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>[筆記] 紀錄在專案中使用過的lodash</title>
    <link href="https://milletbard.github.io/lodash.html"/>
    <id>https://milletbard.github.io/lodash.html</id>
    <published>2019-12-16T06:28:06.000Z</published>
    <updated>2022-05-28T10:27:45.263Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Why-Lodash"><a href="#Why-Lodash" class="headerlink" title="Why Lodash ?"></a>Why Lodash ?</h2><p><strong>Lodash</strong> 在處理 arrays 、numbers、objects、strings 上更加容易，讓 Javascript 變得簡潔。</p><h2 id="在專案中使用-lodash"><a href="#在專案中使用-lodash" class="headerlink" title="在專案中使用 lodash"></a>在專案中使用 lodash</h2><p>透過 <code>npm</code> or <code>yarn</code>安裝：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i lodash</span><br><span class="line">or</span><br><span class="line">yarn add lodash</span><br></pre></td></tr></table></figure><p>可以這樣引入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//只 bundle 需要的功能</span></span><br><span class="line"><span class="keyword">import</span> _map <span class="keyword">from</span> <span class="string">"lodash/map"</span>;</span><br><span class="line"><span class="keyword">import</span> _filter <span class="keyword">from</span> <span class="string">"lodash/filter"</span>;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lodash將整包被 bundle 到輸出檔案中</span></span><br><span class="line"><span class="keyword">import</span> &#123; map, filter &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br></pre></td></tr></table></figure><h2 id="避免將-lodash-全數引入"><a href="#避免將-lodash-全數引入" class="headerlink" title="避免將 lodash 全數引入"></a>避免將 lodash 全數引入</h2><p>可以透過安裝 <a href="https://www.npmjs.com/package/babel-plugin-lodash" target="_blank" rel="noopener">babel-plugin-lodash</a>來避免 lodash 被全數引入，安裝後下列的寫法只會 bundle 需要的功能。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; map, filter &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br></pre></td></tr></table></figure><h2 id="開發專案中用過的-lodash"><a href="#開發專案中用過的-lodash" class="headerlink" title="開發專案中用過的 lodash"></a>開發專案中用過的 lodash</h2><p>defaultTo startsWith</p><h2 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h2><p><strong>map(collection, [iteratee=_.identity])</strong><br>通過迭代集合中元素來創建陣列。</p><pre><code>- collection (Array|Object): 將被遍歷的集合- [iteratee=_.identity] (Function): 每次迭代調用的函數.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; map &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> square = <span class="function">(<span class="params">n</span>) =&gt;</span> n * n;</span><br><span class="line"></span><br><span class="line">map([<span class="number">4</span>, <span class="number">8</span>], square);</span><br><span class="line"><span class="comment">// =&gt; [16, 64]</span></span><br><span class="line"></span><br><span class="line">map(&#123; <span class="attr">a</span>: <span class="number">4</span>, <span class="attr">b</span>: <span class="number">8</span> &#125;, square);</span><br><span class="line"><span class="comment">// // =&gt; [16, 64] (不能保證迭代順序))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = [&#123; <span class="attr">user</span>: <span class="string">"barney"</span> &#125;, &#123; <span class="attr">user</span>: <span class="string">"fred"</span> &#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// // `_.property` 的迭代縮寫.</span></span><br><span class="line">map(users, <span class="string">"user"</span>);</span><br><span class="line"><span class="comment">// // =&gt; ['barney', 'fred']</span></span><br></pre></td></tr></table></figure><p><strong>forEach(collection, [iteratee=_.identity])</strong><br>迭代集合，但不會回傳任何東西，可以通過 return false 提早退出迭代</p><pre><code>- collection (Array|Object): 將被遍歷的集合.- [iteratee=_.identity] (Function): 每次迭代調用的函數.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; forEach &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">forEach([<span class="number">1</span>, <span class="number">2</span>], (value) =&gt; <span class="built_in">console</span>.log(value));</span><br><span class="line"><span class="comment">// =&gt; Logs `1` then `2`.</span></span><br><span class="line"></span><br><span class="line">forEach(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;, (value, key) =&gt; <span class="built_in">console</span>.log(key));</span><br><span class="line"><span class="comment">// =&gt; Logs 'a' then 'b' (不能保證迭代順序).</span></span><br></pre></td></tr></table></figure><p><strong>find(collection, [predicate=_.identity], [fromIndex=0])</strong><br>通過迭代集合找尋指定的元素</p><pre><code>- collection: 將被遍歷的集合- predicate=_.identity : 每次迭代調用的函數- fromIndex : 起始位置</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; find &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = [</span><br><span class="line">  &#123; <span class="attr">user</span>: <span class="string">"barney"</span>, <span class="attr">age</span>: <span class="number">36</span>, <span class="attr">active</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">user</span>: <span class="string">"fred"</span>, <span class="attr">age</span>: <span class="number">40</span>, <span class="attr">active</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">user</span>: <span class="string">"pebbles"</span>, <span class="attr">age</span>: <span class="number">1</span>, <span class="attr">active</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">find(users, (o) =&gt; o.age &lt; <span class="number">40</span>);</span><br><span class="line"><span class="comment">// =&gt; object for 'barney'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// `_.matches` 的迭代縮寫.</span></span><br><span class="line">find(users, &#123; <span class="attr">age</span>: <span class="number">1</span>, <span class="attr">active</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="comment">// =&gt; object for 'pebbles'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// `_.matchesProperty` 的迭代縮寫.</span></span><br><span class="line">find(users, [<span class="string">"active"</span>, <span class="literal">false</span>]);</span><br><span class="line"><span class="comment">// =&gt; object for 'fred'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// `_.property` 的迭代縮寫.</span></span><br><span class="line">find(users, <span class="string">"active"</span>);</span><br><span class="line"><span class="comment">// =&gt; object for 'barney'</span></span><br></pre></td></tr></table></figure><p><strong>includes(collection, value, [fromIndex=0])</strong><br>檢查參考值是否在集合中</p><pre><code>- collection (Array|Object|string): 將被檢查的集合.- value (*): 參考值.- [fromIndex=0](number): 起始位置.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; includes &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">includes([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">1</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line">includes([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line">includes(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line">includes(<span class="string">"abcd"</span>, <span class="string">"bc"</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p><strong>some(collection, [predicate=_.identity])</strong><br>檢查是否有符合條件的元素，一旦判斷到符合條件的元素迭代就會停止。</p><pre><code>- collection (Array|Object): 將被遍歷的集合.- [predicate=_.identity] (Function): 每次迭代調用的函數.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; some &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">some([<span class="literal">null</span>, <span class="number">0</span>, <span class="string">"yes"</span>, <span class="literal">false</span>], <span class="built_in">Boolean</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = [</span><br><span class="line">  &#123; <span class="attr">user</span>: <span class="string">"barney"</span>, <span class="attr">active</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">user</span>: <span class="string">"fred"</span>, <span class="attr">active</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">//  `_.matches` 的迭代縮寫.</span></span><br><span class="line">some(users, &#123; <span class="attr">user</span>: <span class="string">"barney"</span>, <span class="attr">active</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// `_.matchesProperty`的迭代縮寫.</span></span><br><span class="line">some(users, [<span class="string">"active"</span>, <span class="literal">false</span>]);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  `_.property` 的迭代縮寫.</span></span><br><span class="line">some(users, <span class="string">"active"</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><h2 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h2><p><strong>join(array, [separator=’,’])</strong><br>將指定的陣列用分隔符連接起來</p><pre><code>- array (Array): 將被轉換的陣列.- [separator=&apos;,&apos;] (string): 分隔符.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; join &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">join([<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>], <span class="string">"~"</span>);</span><br><span class="line"><span class="comment">// =&gt; 'a~b~c'</span></span><br></pre></td></tr></table></figure><p><strong>findIndex(array, [predicate=_.identity], [fromIndex=0])</strong><br>通過迭代集合找尋指定的元素並回傳該位置的索引值</p><pre><code>- array (Array): 將被檢查的陣列.- [predicate=_.identity] (Function): 每次迭代調用的函數.- [fromIndex=0] (number): 起始位置.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; findIndex &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = [</span><br><span class="line">  &#123; <span class="attr">user</span>: <span class="string">"barney"</span>, <span class="attr">active</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">user</span>: <span class="string">"fred"</span>, <span class="attr">active</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">user</span>: <span class="string">"pebbles"</span>, <span class="attr">active</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">findIndex(users, (o) =&gt; o.user == <span class="string">"barney"</span>);</span><br><span class="line"><span class="comment">// =&gt; 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// `_.matches` 的迭代縮寫.</span></span><br><span class="line">findIndex(users, &#123; <span class="attr">user</span>: <span class="string">"fred"</span>, <span class="attr">active</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"><span class="comment">// =&gt; 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// `_.matchesProperty` 的迭代縮寫.</span></span><br><span class="line">findIndex(users, [<span class="string">"active"</span>, <span class="literal">false</span>]);</span><br><span class="line"><span class="comment">// =&gt; 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  `_.property` 的迭代縮寫.</span></span><br><span class="line">findIndex(users, <span class="string">"active"</span>);</span><br><span class="line"><span class="comment">// =&gt; 2</span></span><br></pre></td></tr></table></figure><p><strong>head(array)</strong><br>獲取陣列的第一個元素</p><pre><code>- array (Array): 要查詢的陣列.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; head &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">head([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="comment">// =&gt; 1</span></span><br><span class="line"></span><br><span class="line">head([]);</span><br><span class="line"><span class="comment">// =&gt; undefined</span></span><br></pre></td></tr></table></figure><h2 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h2><p><strong>floor(number, [precision=0])</strong></p><pre><code>- number : 四捨五入後的數字- [precision=0] : 往後 n 位小數點</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; floor &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">floor(<span class="number">4.006</span>);</span><br><span class="line"><span class="comment">// =&gt; 4</span></span><br><span class="line"></span><br><span class="line">floor(<span class="number">0.046</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// =&gt; 0.04</span></span><br><span class="line"></span><br><span class="line">floor(<span class="number">4060</span>, <span class="number">-2</span>);</span><br><span class="line"><span class="comment">// =&gt; 4000</span></span><br></pre></td></tr></table></figure><h2 id="Lang"><a href="#Lang" class="headerlink" title="Lang"></a>Lang</h2><p><strong>isNull(value)</strong><br>檢查該數值是否為 Null</p><pre><code>- value (*): 將被檢查的數值.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; isNull &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">isNull(<span class="literal">null</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line">isNull(<span class="keyword">void</span> <span class="number">0</span>);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><p><strong>isFinite(value)</strong><br>檢查該數值是否為有限數值</p><pre><code>- value(*): 將被檢查的數值.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="built_in">isFinite</span> &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="number">3</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="built_in">Number</span>.MIN_VALUE);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="literal">Infinity</span>);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="string">"3"</span>);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="number">1000</span> / <span class="number">0</span>);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span>(<span class="number">1000</span> / <span class="number">1</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p><strong>isEmpty(value)</strong><br>檢查該數值是否為空集合</p><pre><code>- value(*): 將被檢查的數值.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; isEmpty &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">isEmpty(<span class="literal">null</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line">isEmpty(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line">isEmpty(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line">isEmpty([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line">isEmpty(&#123; <span class="attr">a</span>: <span class="number">1</span> &#125;);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h2><p><strong>get(object, path, [defaultValue])</strong><br>通過路徑獲取該物件的資料，如果是 undefined 則返回預設數值.</p><pre><code>- object (Object): 要查詢的物件.- path (Array|string): 屬性路徑.- [defaultValue] (*): 預設數值.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">get</span> &#125; from "lodash";</span><br><span class="line"></span><br><span class="line">const object = &#123; a: [&#123; <span class="attr">b</span>: &#123; <span class="attr">c</span>: <span class="number">3</span> &#125; &#125;] &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">get</span>(object, "a[0].b.c");</span><br><span class="line">// =&gt; 3</span><br><span class="line"></span><br><span class="line"><span class="keyword">get</span>(object, ["a", "0", "b", "c"]);</span><br><span class="line">// =&gt; 3</span><br><span class="line"></span><br><span class="line"><span class="keyword">get</span>(object, "a.b.c", "default");</span><br><span class="line">// =&gt; 'default'</span><br></pre></td></tr></table></figure><h2 id="Util"><a href="#Util" class="headerlink" title="Util"></a>Util</h2><p><strong>defaultTo(value, defaultValue)</strong><br>如果數值為 NaN 、 null 、 undefined 就返回預設值</p><pre><code>- value (*): 將被檢查的數值.- defaultValue (*): 預設值.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defaultTo &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">defaultTo(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line"><span class="comment">// =&gt; 1</span></span><br><span class="line"></span><br><span class="line">defaultTo(<span class="literal">undefined</span>, <span class="number">10</span>);</span><br><span class="line"><span class="comment">// =&gt; 10</span></span><br></pre></td></tr></table></figure><h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><p><strong>startsWith([string=’’], [target], [position=0])</strong><br>檢查該位置的字串是否為目標字串</p><pre><code>- [string=&apos;&apos;] (string): 將被檢查的字串.- [target] (string): 想找尋的字串.- [position=0] (number): 想找尋的位置.</code></pre><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; startsWith &#125; <span class="keyword">from</span> <span class="string">"lodash"</span>;</span><br><span class="line"></span><br><span class="line">startsWith(<span class="string">"abc"</span>, <span class="string">"a"</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line">startsWith(<span class="string">"abc"</span>, <span class="string">"b"</span>);</span><br><span class="line"><span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line">startsWith(<span class="string">"abc"</span>, <span class="string">"b"</span>, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><h2 id="結語"><a href="#結語" class="headerlink" title="結語"></a>結語</h2><p>這篇參考<strong><a href="https://jigsawye.com/2017/09/04/make-good-use-of-lodash/" target="_blank" rel="noopener">充分利用 lodash 讓你的程式碼更易讀及維護– JIGSAWYE</a></strong>的文章。</p><p>另外 lodash 還有提供 <strong><a href="https://github.com/lodash/lodash/wiki/FP-Guide" target="_blank" rel="noopener">lodash/fp</a></strong> 能夠使用 Functional Programming 讓程式碼更簡潔，如果有興趣可以看看官方文件或是參考 jigsawye 翻譯的 <strong><a href="https://jigsawye.gitbooks.io/mostly-adequate-guide/content/" target="_blank" rel="noopener">JavaScript Functional Programming 指南</a></strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Why-Lodash&quot;&gt;&lt;a href=&quot;#Why-Lodash&quot; class=&quot;headerlink&quot; title=&quot;Why Lodash ?&quot;&gt;&lt;/a&gt;Why Lodash ?&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Lodash&lt;/strong&gt; 在處理 arrays</summary>
      
    
    
    
    <category term="JavaScript" scheme="https://milletbard.github.io/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>[筆記] 理解 Event Loop,Call Stack, Event &amp; Job Queue in Javascript</title>
    <link href="https://milletbard.github.io/JavaScript-event-loop.html"/>
    <id>https://milletbard.github.io/JavaScript-event-loop.html</id>
    <published>2019-11-25T09:44:23.000Z</published>
    <updated>2022-05-28T10:27:45.259Z</updated>
    
    <content type="html"><![CDATA[<div class="video-container"><iframe src="https://www.youtube.com/embed/8aGhZQkoFbQ" frameborder="0" loading="lazy" allowfullscreen></iframe></div><blockquote><p>JavaScript 最大的優點就是它能夠直接在瀏覽器中運行，不需要任何設置，只需要打開新的瀏覽器並使用 JavaScript 控制台即可執行程式碼。<br>在瀏覽器中，JavaScript 不僅僅是 Runtime engine ( 運行引擎 ) ，還有許多其他的功能，例如：Web Apis ( ex: DOM 、 setTimeout ), callback queue ( 回調序列 ) 以及 event loop ( 事件循環 )。</p></blockquote><h1 id="JavaScript-Runtime-engine-運行引擎"><a href="#JavaScript-Runtime-engine-運行引擎" class="headerlink" title="JavaScript Runtime engine ( 運行引擎 )"></a>JavaScript Runtime engine ( 運行引擎 )</h1><p>每個瀏覽器都有自己的 JS Runtime engine，最著名的就是 google chrome 的 <a href="https://zh.wikipedia.org/wiki/V8_(JavaScript%E5%BC%95%E6%93%8E)" target="_blank" rel="noopener">V8 JavaScript 引擎</a></p><h1 id="Event-Loop-視覺化圖"><a href="#Event-Loop-視覺化圖" class="headerlink" title="Event Loop 視覺化圖"></a>Event Loop 視覺化圖</h1><p><img src="event-loop.png" alt=""></p><h2 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h2><p>JS Runtime 的 Memory Heap 進行記憶體的分配，呼叫堆疊 <code>Call Stack</code>。</p><h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h2><p>JavaScript 逐一執行程式碼的地方稱為堆疊 <code>Stack</code>，當有程式碼片段需要執行就會形成一個<code>frame</code>被堆疊進<code>Stack</code>等待，一旦執行完該<code>frame</code>就會跳出。</p><p>如果是異步執行的程式碼，例如 : setTimeout()、ajax()、Promise、或是 onClick()事件，程式碼會從主堆疊( main stack )中移動到事件表(event table)中。</p><p>如果在函式中執行<code>return</code>，該函式則會在 stack 中直接抽離出來。</p><h2 id="Web-APIS"><a href="#Web-APIS" class="headerlink" title="Web APIS"></a>Web APIS</h2><p>是指瀏覽器額外提供的東西，(ex: DOM、Ajax、setTimeout,etc)</p><h2 id="Callback-Queue"><a href="#Callback-Queue" class="headerlink" title="Callback Queue"></a>Callback Queue</h2><p>異步執行的程式碼會被推到這裏並等待執行。</p><h2 id="Event-Loop"><a href="#Event-Loop" class="headerlink" title="Event Loop"></a>Event Loop</h2><p>接著會來到事件循環，該事件會連續不斷地監聽<code>Stack</code>中是否還有待執行的程式碼片段。</p><p>確認沒有後就換檢查<code>Callback Queue</code>， 如果<code>Callback Queue</code>有準備好的<code>Callback</code>，<code>Event Loop</code>會將第一個準備好的<code>Callback</code>移動到<code>Stack</code>中執行。</p><h2 id="Job-Queue"><a href="#Job-Queue" class="headerlink" title="Job Queue"></a>Job Queue</h2><p>除了<code>Callback Queue</code>，瀏覽器還有另一個佇列叫做<code>Job Queue</code>，這個佇列只保留新功能<code>Promise()</code>的<code>frame</code>。</p><p>當使用到<code>Promise()</code>時即新增了一個 <code>thenable method</code> ，而 <code>thenable method</code> 會被加入到 Job Queue 中，當執行完畢後回傳一個 returned 或是 resolved。</p><blockquote><p>single threaded : JavaScript 是一種單執行緒的程式語言，所有的程式碼會被 stack 中逐一執行，一次只執行一段程式碼。</p></blockquote><h2 id="Blocking-阻塞"><a href="#Blocking-阻塞" class="headerlink" title="Blocking 阻塞"></a>Blocking 阻塞</h2><p>當 <code>main stack</code>具有影響效能的程式碼在某個<code>frame</code>中，其他的程式碼片段就必須等待該<code>frame</code>執行完畢才能有其他的動作(ex: onClick()))，稱為 <strong>阻塞</strong> 。</p><hr><h1 id="Quick-Question-now"><a href="#Quick-Question-now" class="headerlink" title="Quick Question now"></a>Quick Question now</h1><p>試著預測下面的輸出結果：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"message no. 1: Sync"</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"message no. 2: setTimeout"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  resolve();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise</span><br><span class="line">  .then(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"message no. 3: Promise"</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"message no. 4: Promise"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"message no. 5: Sync"</span>);</span><br></pre></td></tr></table></figure><p>有些人可能會預測結果為：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//message no. 1: Sync</span></span><br><span class="line"><span class="comment">//message no. 5: Sync</span></span><br><span class="line"><span class="comment">//message no. 3: Promise</span></span><br><span class="line"><span class="comment">//message no. 4: Promise</span></span><br><span class="line"><span class="comment">//message no. 2: setTimeout</span></span><br></pre></td></tr></table></figure><p>但事實上結果為：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//message no. 1: Sync</span></span><br><span class="line"><span class="comment">//message no. 5: Sync</span></span><br><span class="line"><span class="comment">//message no. 2: setTimeout</span></span><br><span class="line"><span class="comment">//message no. 3: Promise</span></span><br><span class="line"><span class="comment">//message no. 4: Promise</span></span><br></pre></td></tr></table></figure><p>為什麼呢？ 這是因為 <code>Job Queue</code>有較高的優先權，所以當主堆疊中的<code>frame</code>執行完後， <code>Event Loop</code> 會優先檢查及執行 <code>Job Queue</code>裡的作業，全部執行完後才會到 `Callback Queue。</p><hr><h1 id="Code-execution-notes"><a href="#Code-execution-notes" class="headerlink" title="Code execution notes"></a>Code execution notes</h1><ul><li><p><code>async code</code>會在<code>main stack</code>全部執行完畢後才開始執行。</p></li><li><p><code>main stack</code>中當下的<code>statements</code>及<code>functions</code>會執行完畢，過程中無法被<code>async code</code>中斷。</p></li><li><p>因為須等待<code>main stack</code>執行完畢，因此不能保證<code>async code</code>將在指定的時間準確執行，如果<code>main stack</code>正忙於執行當下的程式，那<code>async code</code>將被延遲。</p></li><li><p>就算 <code>setTimeout()</code>延遲時間設定為 0 ，程式也不會立即被執行，依然會被排在 <code>Callback Queue</code>等待<code>main stack</code>結束。</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"message no. 1: setTimeout"</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"message no. 2: Sync"</span>);</span><br></pre></td></tr></table></figure><p>結果為：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// message no. 2: Sync</span></span><br><span class="line"><span class="comment">// message no. 1: setTimeout</span></span><br></pre></td></tr></table></figure><hr><h3 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h3><ul><li><p><a href="https://medium.com/@Rahulx1/understanding-event-loop-call-stack-event-job-queue-in-javascript-63dcd2c71ecd" target="_blank" rel="noopener">Understanding Event Loop, Call Stack, Event &amp; Job Queue in Javascript</a></p></li><li><p><a href="https://pjchender.blogspot.com/2017/08/javascript-learn-event-loop-stack-queue.html" target="_blank" rel="noopener">[筆記] 理解 JavaScript 中的事件循環、堆疊、佇列和併發模式（Learn event loop, stack, queue, and concurrency mode of JavaScript in depth）</a></p></li><li><p><a href="https://wsvincent.com/javascript-event-loop/" target="_blank" rel="noopener">JavaScript Event Loop</a></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;video-container&quot;&gt;&lt;iframe src=&quot;https://www.youtube.com/embed/8aGhZQkoFbQ&quot; frameborder=&quot;0&quot; loading=&quot;lazy&quot; allowfullscreen&gt;&lt;/iframe</summary>
      
    
    
    
    <category term="JavaScript" scheme="https://milletbard.github.io/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>[筆記] 透過 Hexo + GitHub 建立個人部落格</title>
    <link href="https://milletbard.github.io/create-hexo-blog.html"/>
    <id>https://milletbard.github.io/create-hexo-blog.html</id>
    <published>2019-10-14T08:41:38.000Z</published>
    <updated>2022-05-28T10:27:45.262Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hexo 是一個快速、簡單且強大的網誌框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在幾秒鐘內透過漂亮的主題產生靜態檔案。</p></blockquote><h3 id="安裝需求"><a href="#安裝需求" class="headerlink" title="安裝需求"></a>安裝需求</h3><ul><li><a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a> (Node.js 版本需不低於 8.6，建議使用 Node.js 10.0 及以上版本)</li><li><a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a></li></ul><h3 id="安裝Hexo"><a href="#安裝Hexo" class="headerlink" title="安裝Hexo"></a>安裝<code>Hexo</code></h3><p>接下來透過<code>npm</code>安裝<code>Hexo</code></p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>安裝完後查看<code>Hexo</code>版本</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo version</span><br></pre></td></tr></table></figure><p>接下來就可以開始初始化部落格</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo init blog <span class="comment">#初始化blog</span></span><br><span class="line"><span class="built_in">cd</span> blog <span class="comment">#移動到blog的根目錄</span></span><br><span class="line">npm install <span class="comment"># 安裝相關套件</span></span><br></pre></td></tr></table></figure><h3 id="配置GitHub"><a href="#配置GitHub" class="headerlink" title="配置GitHub"></a>配置<code>GitHub</code></h3><p>在 <a href="https://github.com/" target="_blank" rel="noopener">GitHub</a>新增一個名稱為 <code>yourname.github.io</code> 的 Repositories</p><blockquote><p><code>yourname</code> 換成自己的帳號</p></blockquote><h3 id="回到剛剛創建的blog資料夾"><a href="#回到剛剛創建的blog資料夾" class="headerlink" title="回到剛剛創建的blog資料夾"></a>回到剛剛創建的<code>blog</code>資料夾</h3><ol><li>在<code>blog</code>根目錄找<code>_config.yml</code>的檔案，這支檔案是用來作全域配置的文件</li><li>在<code>_config.yml</code>檔案找</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type:</span><br></pre></td></tr></table></figure><p>改成這樣</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https:&#x2F;&#x2F;github.com&#x2F;yourname&#x2F;yourname.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><blockquote><p>參數後面記得留一個空格</p></blockquote><ol start="3"><li>安裝<code>hexo-deployer-git</code>套件</li></ol><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><ol start="4"><li>產生靜態文件,部署到<code>GitHub</code>上</li></ol><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d -g</span><br></pre></td></tr></table></figure><p>等一段時間後就能到<code>https://yourname.github.io/</code>查看有沒有成功部署，接下來就可以開始寫文章哩。</p><h2 id="使用-Themes-Hexo-主題"><a href="#使用-Themes-Hexo-主題" class="headerlink" title="使用 Themes Hexo 主題"></a>使用 <code>Themes Hexo</code> 主題</h2><p>在 <a href="https://hexo.io/themes/index.html" target="_blank" rel="noopener">Themes</a> 選一個自己喜歡的主題，並參考官方文件做就可以了。</p><h2 id="發布文章"><a href="#發布文章" class="headerlink" title="發布文章"></a>發布文章</h2><p>創建文章</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new [postName]</span><br></pre></td></tr></table></figure><blockquote><p>前往 source / _post 資料夾中，找到創建的 [postName].md 文件，開始撰寫內容。</p></blockquote><p>部署內容</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d -g    <span class="comment"># d = 部署, g = 生成</span></span><br></pre></td></tr></table></figure><p>如果想在 <code>local</code> 端先確認內容，可以用</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server <span class="comment">#執行</span></span><br></pre></td></tr></table></figure><hr><ul><li><p>如果不熟悉 <code>Markdown</code>，<a href="https://markdown.tw/#hr" target="_blank" rel="noopener">Markdown</a></p></li><li><p>如果想用線上編輯器，<a href="https://hackmd.io/sHXhBDrtQh-nzU5oeVotGw" target="_blank" rel="noopener">HackMD</a>、<a href="https://markdown-editor.github.io/" target="_blank" rel="noopener">markdown-editor</a></p></li><li><p>如果用的編輯器是<code>vscode</code>，可以看看<a href="https://marketplace.visualstudio.com/items?itemName=mdickin.markdown-shortcuts" target="_blank" rel="noopener">Markdown Shortcuts</a>跟<a href="https://marketplace.visualstudio.com/items?itemName=bierner.markdown-preview-github-styles" target="_blank" rel="noopener">Markdown Preview Github Styling</a></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;Hexo 是一個快速、簡單且強大的網誌框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在幾秒鐘內透過漂亮的主題產生靜態檔案。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;安裝需求&quot;&gt;&lt;a href=&quot;#安裝需求&quot; clas</summary>
      
    
    
    
    <category term="hexo" scheme="https://milletbard.github.io/categories/hexo/"/>
    
    
  </entry>
  
</feed>
